---
# Pandoc configuration file for "Architecture as Code" book
# Simplified configuration for better compatibility

# General settings
standalone: true
toc: true
toc-depth: 3
number-sections: true

# Chapter page break configuration
top-level-division: chapter

# Template and styling - Try Eisvogel first, fallback to default
template: eisvogel.latex

# PDF-specific settings
pdf-engine: xelatex

# Syntax highlighting configuration
highlight-style: tango
# Alternative highlight styles: pygments, kate, monochrome, espresso, zenburn, haddock, breezedark, tango

# Metadata for document
metadata:
  title: "Architecture as Code"
  subtitle: "A practical handbook for Infrastructure as Code"
  author: "Architecture as Code Editorial Team"
  date: "2024"
  language: en-GB
  lang: en-GB

# Variables for better compatibility
variables:
  documentclass: book
  classoption:
    - twoside
    - openany
  geometry:
    - top=2.5cm
    - bottom=2.5cm
    - left=2.5cm
    - right=2.5cm
  fontsize: 11pt
  linestretch: 1.2
  lang: en-GB
  include-before: |
    \newpage
    \thispagestyle{empty}
    \begin{center}
    \vspace*{0.05\textheight}
    \includegraphics[width=\paperwidth,height=0.75\paperheight,keepaspectratio]{images/book-cover.png}
    \vspace{0.04\textheight}
    {\Huge\bfseries Architecture as Code\par}
    \vspace{0.75cm}
    {\Large\itshape A practical handbook for Infrastructure as Code\par}
    \vspace{0.75cm}
    {\large Architecture as Code Editorial Team\par}
    {\large 2024\par}
    \vspace{0.5cm}
    {\normalsize A comprehensive British English guide covering modern Infrastructure as Code practices, organisational governance, and architectural automation for cloud-native delivery teams.\par}
    \vspace*{0.1\textheight}
    \end{center}
    \newpage
  # Simplified header handling
  header-includes: |
    \usepackage{fancyhdr}
    \usepackage{titlesec}
    \setlength{\headheight}{14pt}
    \pagestyle{fancy}
    \fancyhf{}
    \newcommand{\currentpartletter}{}
    \newcommand{\currentparttitle}{}
    \newcommand{\currentpartformat}{}
    \newcommand{\setbookpart}[1]{%
      \renewcommand{\currentpartletter}{\thepart}%
      \renewcommand{\currentparttitle}{#1}%
      \renewcommand{\currentpartformat}{PART~\thepart\space-\space #1}%
    }
    \renewcommand{\chaptermark}[1]{\markboth{\thechapter.\ #1}{}}
    % Show only the current chapter title in the running header to avoid
    % duplicating the part name alongside the chapter label.
    \fancyhead[LO]{\small\bfseries \leftmark}
    \fancyhead[LE]{\small\bfseries \leftmark}
    \fancyhead[RO]{}
    \fancyhead[RE]{}
    \fancyfoot[C]{\thepage}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\partname}{Part}
    \renewcommand{\thepart}{\Alph{part}}
    \titleformat{\part}[display]
      {\bfseries\centering\Huge}
      {PART \thepart}
      {0pt}
      {\thispagestyle{empty}\vspace*{0.5\textheight}}
    \titlespacing*{\part}{0pt}{0pt}{0pt}
    \usepackage{graphicx}
    \usepackage{pdfpages}

# For EPUB output
epub-chapter-level: 1

# Additional filters for better output
filters: []